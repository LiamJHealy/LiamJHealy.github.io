I"ô<h3 id="decltypeç”¨æ³•"><strong>decltypeç”¨æ³•:</strong></h3>

<p>In C++11, perhaps the primary use for decltypeis declaring function templates where the <strong>functionâ€™s return typedepends on its parameter types.</strong></p>

<p>decltype ç”¨äºè·å¾—æŸä¸ªæœªçŸ¥å˜é‡çš„ç±»å‹ï¼Œåœ¨ä»€ä¹ˆæƒ…å†µä¸‹æˆ‘ä»¬ä¸çŸ¥é“å˜é‡çš„ç±»å‹å‘¢ï¼Ÿ
å½“ç„¶æ˜¯ä½¿ç”¨templateæˆ–autoçš„æ—¶å€™ï¼š</p>

<div class="language-c++ highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span style="color: #6c71c4">template</span><span style="color: #93a1a1">&lt;</span><span style="color: #6c71c4">typename</span> <span style="color: #b58900">T</span><span style="color: #93a1a1">&gt;</span>
<span style="color: #cb4b16">void</span> <span style="color: #586e75">funcValue</span><span style="color: #93a1a1">(</span><span style="color: #586e75">T</span> <span style="color: #586e75">param</span><span style="color: #93a1a1">)</span>
<span style="color: #93a1a1">{</span>
	<span style="color: #6c71c4">auto</span> <span style="color: #586e75">subParam</span> <span style="color: #93a1a1">=</span> <span style="color: #586e75">param</span><span style="color: #93a1a1">;</span>
	<span style="color: #6c71c4">decltype</span><span style="color: #93a1a1">(</span><span style="color: #6c71c4">auto</span><span style="color: #93a1a1">)</span> <span style="color: #586e75">subSubParam</span> <span style="color: #93a1a1">=</span> <span style="color: #586e75">subParam</span><span style="color: #93a1a1">;</span>
<span style="color: #93a1a1">}</span>
</code></pre></div></div>

<!-- more -->

<h3 id="å¤§æ‹¬å·ç”¨æ³•"><strong>å¤§æ‹¬å·ç”¨æ³•</strong></h3>

<p><strong>åˆå§‹åŒ–ä½¿ç”¨å¤§æ‹¬å·ï¼ˆç»Ÿä¸€åˆå§‹åŒ–ç¬¦å·ï¼‰ï¼š</strong></p>

<div class="language-c++ highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span style="color: #586e75">std</span><span style="color: #93a1a1">::</span><span style="color: #586e75">vector</span><span style="color: #93a1a1">&lt;</span><span style="color: #cb4b16">int</span><span style="color: #93a1a1">&gt;</span> <span style="color: #586e75">v</span><span style="color: #93a1a1">{</span> <span style="color: #859900">1</span><span style="color: #93a1a1">,</span> <span style="color: #859900">3</span><span style="color: #93a1a1">,</span> <span style="color: #859900">5</span> <span style="color: #93a1a1">};</span> <span style="color: #657b83">// v's initial content is 1, 3, 5 </span>
</code></pre></div></div>

<p><strong>åˆå§‹åŒ–ç±»æˆå‘˜å‡½æ•°ç›´æ¥ç”¨å¤§æ‹¬å·ï¼š</strong></p>

<div class="language-c++ highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span style="color: #6c71c4">class</span> <span style="color: #b58900">Widget</span> <span style="color: #93a1a1">{</span>
<span style="color: #002b36;background-color: #dc322f">â€¦</span>
<span style="color: #586e75">private:</span>
<span style="color: #cb4b16">int</span> <span style="color: #586e75">x</span><span style="color: #93a1a1">{</span> <span style="color: #859900">0</span> <span style="color: #93a1a1">};</span> <span style="color: #657b83">// fine, x's default value is 0</span>
<span style="color: #cb4b16">int</span> <span style="color: #586e75">y</span> <span style="color: #93a1a1">=</span> <span style="color: #859900">0</span><span style="color: #93a1a1">;</span> <span style="color: #657b83">// also fine</span>
<span style="color: #cb4b16">int</span> <span style="color: #586e75">z</span><span style="color: #93a1a1">(</span><span style="color: #859900">0</span><span style="color: #93a1a1">);</span> <span style="color: #657b83">// error!</span>
<span style="color: #93a1a1">};</span> 
</code></pre></div></div>

<p><strong>æ€»ä¹‹ï¼Œä»¥å‰ä½¿ç”¨()å’Œ=çš„åœ°æ–¹ï¼Œç»Ÿç»Ÿç”¨å¤§æ‹¬å·ä»£æ›¿ï¼Œè‚¯å®šæ²¡é”™</strong></p>

<p><strong>ä½†æ˜¯ï¼Œå¤§æ‹¬å·ä¸å…è®¸éšå¼ç±»å‹è½¬æ¢ï¼š</strong></p>

<div class="language-c++ highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span style="color: #cb4b16">double</span> <span style="color: #586e75">x</span><span style="color: #93a1a1">,</span> <span style="color: #586e75">y</span><span style="color: #93a1a1">,</span> <span style="color: #586e75">z</span><span style="color: #93a1a1">;</span>
<span style="color: #cb4b16">int</span> <span style="color: #586e75">sum1</span><span style="color: #93a1a1">{</span> <span style="color: #586e75">x</span> <span style="color: #93a1a1">+</span> <span style="color: #586e75">y</span> <span style="color: #93a1a1">+</span> <span style="color: #586e75">z</span> <span style="color: #93a1a1">};</span> <span style="color: #657b83">// error! sum of doubles may  not be expressible as int</span>
</code></pre></div></div>

<p><strong>æ­¤å¤–ï¼Œå½“æˆ‘ä»¬ä½¿ç”¨ std::initializer_list åˆå§‹åŒ–ä¸€ä¸ªç±»æ—¶ï¼Œå¿…é¡»ä½¿ç”¨å¤§æ‹¬å·ï¼š</strong></p>

<div class="language-c++ highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span style="color: #6c71c4">class</span> <span style="color: #b58900">Widget</span>
<span style="color: #93a1a1">{</span>
<span style="color: #586e75">public:</span>
	<span style="color: #586e75">Widget</span><span style="color: #93a1a1">(</span><span style="color: #586e75">std</span><span style="color: #93a1a1">::</span><span style="color: #586e75">initializer_list</span><span style="color: #93a1a1">&lt;</span><span style="color: #cb4b16">int</span><span style="color: #93a1a1">&gt;</span> <span style="color: #586e75">il</span><span style="color: #93a1a1">)</span>
	<span style="color: #93a1a1">{</span>
		<span style="color: #cb4b16">int</span> <span style="color: #586e75">i</span> <span style="color: #93a1a1">=</span> <span style="color: #859900">0</span><span style="color: #93a1a1">;</span>
		<span style="color: #6c71c4">for</span> <span style="color: #93a1a1">(</span><span style="color: #6c71c4">auto</span> <span style="color: #586e75">itre</span> <span style="color: #93a1a1">=</span> <span style="color: #586e75">il</span><span style="color: #93a1a1">.</span><span style="color: #586e75">begin</span><span style="color: #93a1a1">();</span> <span style="color: #586e75">itre</span> <span style="color: #93a1a1">!=</span> <span style="color: #586e75">il</span><span style="color: #93a1a1">.</span><span style="color: #586e75">end</span><span style="color: #93a1a1">();</span> <span style="color: #586e75">itre</span><span style="color: #93a1a1">++</span><span style="color: #93a1a1">,</span><span style="color: #586e75">i</span><span style="color: #93a1a1">++</span><span style="color: #93a1a1">)</span>
			<span style="color: #586e75">m_l</span><span style="color: #93a1a1">[</span><span style="color: #586e75">i</span><span style="color: #93a1a1">]</span> <span style="color: #93a1a1">=</span> <span style="color: #93a1a1">*</span><span style="color: #586e75">itre</span><span style="color: #93a1a1">;</span>
	<span style="color: #93a1a1">}</span>
<span style="color: #586e75">private:</span>
	<span style="color: #cb4b16">int</span> <span style="color: #586e75">m_l</span><span style="color: #93a1a1">[</span><span style="color: #859900">256</span><span style="color: #93a1a1">];</span>
<span style="color: #93a1a1">};</span>

<span style="color: #586e75">Widget</span> <span style="color: #586e75">w4</span><span style="color: #93a1a1">{</span> <span style="color: #859900">1</span><span style="color: #93a1a1">,</span><span style="color: #859900">2</span><span style="color: #93a1a1">,</span><span style="color: #859900">3</span><span style="color: #93a1a1">,</span><span style="color: #859900">4</span> <span style="color: #93a1a1">};</span>
</code></pre></div></div>

<p><strong>å¹¶ä¸”ä½¿ç”¨è¿™ç§åˆå§‹åŒ–æ–¹æ³•ä¸æ”¯æŒéšå¼ç±»å‹è½¬æ¢</strong></p>

:ET